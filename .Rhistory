library(devtools)
install_github('Bioinformatics-Support-Unit/bsudata')
install_github('Bioinformatics-Support-Unit/bsudata')
data(txi)
bsudata::counts
bsudata::quant_table
data(quant_table)
data(bsudata::quant_table)
quant_table
data(quant_table, package='bsu_data')
data(quant_table, package='bsudata')
data('quant_table', package='bsudata')
data(quant_table, package=bsudata)
data(bsudata)
data('bsudata')
data(package='bsudata')
data()
data('quant_table')
data('bsudata::quant_table')
library(knitr)
include_graphics('~/Code/ngs-linux/Intro_To_Practical_Bioinformatics/media/rstudio.png')
install.packages('tufte')
knitr::include_graphics('~/Code/ngs-linux/Intro_To_Practical_Bioinformatics/media/rstudio.png')
install.packages('BiocManager')
library('BiocManager')
BiocManager::install('Bioinformatics-Support-Unit/bsudata')
BiocManager::install('remotes')
BiocManager::install('Bioinformatics-Support-Unit/bsudata')
install(c('devtools', 'tidyverse',
'Bioinformatics-Support-Unit/bsudata',
'DESeq2', 'pheatmap'))
?install.packages
?chooseCRANmirror()
library(bsudata)
data(quant_table)
data(bsudata::quant_table)
bsudata::quant_table
bsudata::counts
library(devtools)
install_github('Bioinformatics-Support-Unit/bsudata')
library(bsudata)
counts
counts
data(counts)
data(bsudata::counts)
counts
install_github('Bioinformatics-Support-Unit/bsudata')
library(bsudata)
counts
count_table
bsu_data::count_table
bsudata::count_table
bsudata::T48_vs_A_sig
detach("package:bsudata", unload=TRUE)
install_github('Bioinformatics-Support-Unit/bsudata')
install_github('Bioinformatics-Support-Unit/bsudata', force=TRUE)
library(bsudata)
bsudata::T48_vs_A_sig
T48_vs_A_sig
data(bsudata)
data('T48_vs_A_sig')
T48_vs_A_sig
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
library(knitr)
library(tidyverse)
library(DESeq2)
library(pheatmap)
library(bsudata)
data("count_table")
head(count_table)
data("T96_vs_B_sig")
filter(T96_vs_B_sig, 1:20)
top20_genes = slice(T96_vs_B_sig, 1:20)
T96_vs_B_sig
type(T96_vs_B_sig)
class(T96_vs_B_sig)
is.tibble(T96_vs_B_sig)
?slice
top20_genes = dplyr::slice(T96_vs_B_sig, 1:20)
top20_ensembl = select(top20_genes, ensembl_geneid)
top20_counts = filter(count_table, ensembl_geneid %in% top20_ensembl)
top20_ensembl
top20_ensembl = pull(top20_genes, ensembl_geneid)
top20_counts = filter(count_table, ensembl_geneid %in% top20_ensembl)
top20_matrix = select(top20_counts, -starts_with("ensembl")) %>% as.matrix
heatmap(top20_matrix)
rownames(top20_matrix) = pull(top20_genes, symbol)
heatmap(top20_matrix)
top20_counts
d = dist(top20_matrix)
h = hclust(d)
plot(h)
View(top20_counts)
top20_genes
View(top20_genes)
match(count_table$ensembl_geneid, top20_ensembl)
match(top20_ensembl, count_table$ensembl_geneid)
top20_counts = slice(count_table, match(top20_ensembl, count_table$ensembl_geneid))
top20_counts = dplyr::slice(count_table, match(top20_ensembl, count_table$ensembl_geneid))
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
library(knitr)
library(DESeq2)
library(pheatmap)
library(bsudata)
library(tidyverse)
top20_matrix = select(top20_counts, -starts_with("ensembl")) %>% as.matrix
rownames(top20_matrix) = pull(top20_genes, symbol)
heatmap(top20_matrix)
d= dist(top20_matrix)
h = hclust(d)
plot(h)
heatmap(top20_matrix)
pheatmap(top20_matrix)
top20_matrix
pheatmap(log2(top20_matrix+1))
?pheatmap
library(ComplexHeatmap)
?Heatmap
pheatmap(log2(top20_matrix+1), )
library(gplots)
heatmap.2(log2(top20_matrix+1))
sample_table
?pheatmap
pheatmap(log2(top20_matrix+1), annotation_col=sample_table)
detach("package:bsudata", unload=TRUE)
install_github('Bioinformatics-Support-Unit/bsudata')
library(bsudata)
data("top20_matrix")
data("fc_matrix")
pheatmap(fc_matrix)
max(abs(fc_matrix))
big_fc <- max(abs(fc_matrix))
seq(-big_fc, big_fc, length.out = 100)
hm_breaks <- seq(-big_fc, big_fc, length.out = 101)
pheatmap(fc_matrix, breaks=hm_breaks)
pheatmap(fc_matrix)
pheatmap(fc_matrix, breaks=hm_breaks)
pheatmap(fc_matrix, breaks=hm_breaks, color = redblue(100))
pheatmap(fc_matrix, breaks=hm_breaks, color = bluered(100))
library(RColorBrewer)
display.brewer.all()
pheatmap(fc_matrix, breaks=hm_breaks, color = colorRampPalette(rev(brewer.pal(9, "RdB u"))(100))
pheatmap(fc_matrix, breaks=hm_breaks, color = colorRampPalette(rev(brewer.pal(9, "RdB u"))(100))
pheatmap(fc_matrix, breaks=hm_breaks, color = colorRampPalette(rev(brewer.pal(9, "RdB u")))(100))
colorRampPalette(rev(brewer.pal(9, "RdB u")))
pheatmap(fc_matrix, breaks=hm_breaks, color = colorRampPalette(rev(brewer.pal(9, "RdBu")))(100))
pheatmap(fc_matrix, breaks=hm_breaks, color = colorRampPalette(rev(brewer.pal(11, "RdBu")))(100))
?bluered
colorpanel(100, 'blue', 'white')
pheatmap(log2(top20_matrix+1), color = colorpanel(100, 'blue', 'white'))
pheatmap(log2(top20_matrix+1), color = colorpanel(100, 'purple', 'blue', 'white'))
ls('package:bsudata')
data(package='bsudata')
knitr::include_graphics('~/Code/ngs-linux/RNA_Seq_Data_Analysis/media/pca.png')
knitr::include_graphics('~/Code/ngs-linux/RNA_Seq_Data_Analysis/media/ma.png')
pheatmap(top_genes_counts)
transformed_counts = log2(top_genes_counts + 1)
pheatmap(transformed_counts)
colors()
library(gplots)
mycolours = colorpanel(n=100, low='blue', high='white')
pheatmap(transformed_counts, color = mycolours)
pheatmap(fc_matrix)
mycolours2 = colorpanel(n=100, low='blue', mid='white', high='red')
pheatmap(fc_matrix, breaks=hm_breaks, color = bluered(100))
data("top_genes_counts")
data("top20_matrix")
sample_table
View(sample_table)
